<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 5.0//EN">
<html>
<head>
<title>LDAP Address Book - User Guide</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="styles.css" type="text/css">
<link rel="icon" type="image/png" href="addressbook24.png">
</head>
<body>

<table>
  <tr>
    <td style="background-color:white">
      <img alt="LDAP Address Book Icon" src="addressbook48.png">
    </td>
    <th style="background-color:white;text-align:left">
      <h1 style="margin:0">LDAP Address Book</h1>
      <div style="font-weight:normal">Web-based LDAP address book browser/editor</div>
    </th>
  </tr>
</table>
<hr>
<h2>Contents</h2>

<ol>
<li><a href="#getting_started">Getting Started Using the Address Book</a>
  <ol>
  <li>Mozilla Firefox Search Integration
  <li>Google Chrome/Chromium Search Integration
  </ol>
<li><a href="#installation">Installation and Basic Setup</a>
  <ol>
  <li>Upgrading from Previous Versions
  <li>Installation on Linux: Apache HTTP Server on Debian/Ubuntu
  <li>Installation on Windows: Apache HTTP Server or Microsoft IIS
  <li>Set up access to the directory service
  </ol>
<li><a href="#customising">Customising the Address Book</a>
  <ol>
  <li>Configuring users and permissions
  <li>Changing the attributes shown for search results
  <li>Applying language-specific sorting rules for search results
  <li>Applying custom LDAP filters to directory browsing and searching
  <ol>
    <li>Directory browsing
    <li>Search results
  </ol>
  <li>Changing the layout and attributes shown for directory entries
  <li>Displaying thumbnail photos or logos when browsing/searching the directory
  <li>Setting up phone numbers to be dialed when clicked on
  <li>Changing the links shown in the page footer
  <li>Changing the look and formatting of the address book
  </ol>
<li><a href="#config_reference">Configuration reference</a>
</ol>
<hr>
<a name="getting_started"></a>
<h2>Getting Started Using the Address Book</h2>
<p>
LDAP Address Book is a web application for browsing and searching
for contact details within an LDAP directory service, allowing it
to be used as an address book. It has been tested on the following
LDAP directories:
</p>
<ul>
<li>Active Directory (Microsoft and Samba implementations)
<li>Novell eDirectory
<li>OpenLDAP (provisional support)
</ul>
<p>
Searching your LDAP address book is pretty easy. Just type in
the name, job title or company of who you're trying to find into
search box and click "Search" (or press Return). Alternatively
if the directory has been classified into "organisational units"
(OUs) you can click on the folders underneath the search box to browse
records by department, building, etc.
</p>
<p>
<img alt="How to Search or Browse the Address Book" src="search_browse.png">
</p>
<p>
You can add the LDAP Address Book as a search engine in Firefox,
Google Chrome/Chromium and other OpenSearch compliant web browsers,
allowing you to search more easily.
</p>
<h3>Mozilla Firefox Search Integration</h3>
<p>
To add the Address Book as a search engine in Firefox:
</p>
<ol>
<li>Open web browser and navigate to the address book.
<li>Click the icon to the left of the search engine name in the search
box.
<li>Select <b>Add "Address Book"</b> (or the name of your address
book, if it has been changed from the default) from the menu.
</ol>
<p>
<img alt="Address book OpenSearch integration in Firefox" src="opensearch_firefox.png">
</p>
<h3>Google Chrome/Chromium Search Integration</h3>
<p>
To add the Address Book as a search engine in Google Chrome or Chromium:
</p>
<ol>
<li>Open web browser and navigate to the address book.
<li>Chromium/Google Chrome will automatically add the
    LDAP Address Book to the available search engines.
</ol>
<p>
To search the Address Book, first enter the first few characters
of the site URL, then press <kbd>Tab</kbd> when prompted.
</p>
<p>
<img alt="Selecting Address Book OpenSearch in Chromium Browser" src="opensearch_chromium1.png">
</p>
<p>
Now enter the name you wish to search for.
</p>
<p>
<img alt="Using Address Book OpenSearch in Chromium Browser" src="opensearch_chromium2.png">
</p>
<hr>
<a name="installation"></a>
<h2>Installation and Basic Setup</h2>
<p>
The remainder of this document is aimed towards system administrators
setting up and configuring LDAP address book on your network.
</p>
<h3>Upgrading from Previous Versions</h3>
<p>
The general method of upgrading to a new version of the Address Book
is to replace the application's program files with those from the
new release.
</p>
<p>
In many cases your previous configuration (stored in file
<code>config.php</code>) can be reused with only minor changes
(if any). Details of what needs to be done for each version
can be found on the project Wiki:
</p>
<p>
<a href="https://sourceforge.net/p/ldap-addr-book/wiki/Home/">
https://sourceforge.net/p/ldap-addr-book/wiki/Home/</a>
</p>
<p>
This information is available for version 0.10 onwards.
</p>
<h3>Installation on Linux: Apache HTTP Server on Debian/Ubuntu</h3>
<p>
Install Apache HTTP Server, together with PHP and PHP/LDAP integration:
</p>
<pre>
apt-get install apache2 php5 libapache2-mod-php5 php5-intl php5-ldap
</pre>
<p>
Decide where you want to store the address book web site's files
and unpack the address book tar.gz file to the web site directory.
For the purposes of this guide, this location is assumed to be
<code>/srv/www/addressbook.example.org</code> and the URL of the
address book <code>http://addressbook.example.org/</code>, in
which case you might type:
</p>
<pre>
mkdir -p /srv/www/addressbook.example.org
cd /srv/www/addressbook.example.org
tar xvzf ~/ldap-addr-book-0.02.tar.gz
</pre>
<p>
Create the file
<code>/etc/apache2/sites-available/addressbook.example.org</code>
and add the following contents:
</p>
<pre>
&lt;VirtualHost *:80&gt;
        DocumentRoot /srv/www/addressbook.example.org
        ServerAdmin webmaster@example.org
        ServerName addressbook.example.org

        ServerSignature email
        DirectoryIndex index.html index.php

        LogFormat "combined"
        TransferLog /var/log/apache2/addressbook.example.org-access_log
        ErrorLog /var/log/apache2/addressbook.example.org-error_log
&lt;/VirtualHost&gt;
</pre>
<p>
Enable the site by running the command:
</p>
<p>
<code>a2ensite addressbook.example.org</code>
</p>
<p>
Perform a graceful restart of Apache in order to re-read the
configuration and make the new web site live:
</p>
<p>
<code>apache2ctl graceful</code>
</p>

<p>
Finally create a DNS record for the address book web site, e.g.:
</p>
<pre>addressbook.example.org.	IN	CNAME	myserver
</pre>

<h3>Installation on Windows: Apache HTTP Server or Microsoft IIS</h3>

<p>
In outline, the procedure to set up the LDAP Address Book to run
under Windows is as follows:
</p>

<ul>
<li>Install preferred web server (e.g. Apache HTTP Server or Microsoft IIS).

<li>Download PHP 5, e.g. from 
    <a href="http://windows.php.net/download/">http://windows.php.net/download/</a>
    or a trusted mirror.

<li>Install PHP 5, ensuring that LDAP and INTL support are both enabled.

<li>Set up a new virtual host or folder for the Address Book and
    extract the install media to it.

<li>If necessary, create a DNS record for the address book web site.
</ul>

<h3>Set up access to the directory service</h3>
<p>
The LDAP Address Book will need at least one user login
account on the directory service in order to access its
contents. This can be either:
</p>
<ul>
<li>A generic "default" user account, which typically
    provides read-only access for searching or browsing records.
<li>Individual (named) login accounts (e.g. admin/editing
    permissions in future versions of the Address Book)
</ul>
<p>
If you just want to get the LDAP Address Book up and running
quickly, set up a new user account that provides read-only
access to your directory, open the file <code>config.php</code>
in your preferred text editor and fill in
<code>$ldap_default_user</code> and
<code>$ldap_default_password</code> with the account's
credentials.
</p>
<p>
You will also need to fill in the following settings:
</p>
<ul>
<li><p><code>$ldap_server</code> - Specify the type, host name and
    (optionally) port number of the directory server (domain controller)
    to connect to.</p>

<li><p><code>$ldap_base_dn</code> - Set to the location in the directory
(e.g. OU) that should be used as the "root" of the address book information.</p>
</ul>
<p>
See the <a href="#config_reference">Configuration Reference</a> section
below for further information on these and other settings.
</p>
<p>
Note: Windows users may experience problems opening the <code>config.php</code>
file using the Notepad text editor. Try downloading and using
Notepad++ instead, which supports correct handling of UNIX-style
newline characters.
</p>
<p>
Note: Some LDAP directory servers may allow read only access
with a blank user name/password ("anonymous
bind"). If this is the case then you may find that you
don't need to create a new user account or fill in
<code>$ldap_default_user</code> or <code>$ldap_default_password</code>
at all.
</p>
<hr>
<a name="customising">
<h2>Customising the Address Book</h2>

<h3>Configuring users and permissions</h3>
<p>
The LDAP address book supports logging in with named user
accounts. Typically, this is used by administrators
who are permitted to edit the address book contents, or
if you need to limit browsing/searching access to known
users.
</p>
<p>
Set the following option in <code>config.php</code> to allow
different users to log into the directory:
</p>
<pre>
$ldap_login_enabled = true;
</pre>
<p>
<img alt="Log In link - Visible when per-user login enabled" src="login_enabled.png">
</p>
<p>
User login names, passwords and permissions are taken from the
LDAP directory itself rather than the address book application.
</p>
The <code>$ldap_user_map</code> configuration setting describes
the relationship between the address book's login names and
the corresponding LDAP bind user names and permissions within the
back-end directory. Each entry in specifies how a login name for
the address book (<code>login_name</code>) maps onto a back-end LDAP
directory user (<code>ldap_name</code>).
</p>
<ul>
<li>The special login name <code>__ANONYMOUS__</code> is used to specify the
    LDAP login details that the address book should use use when nobody
    is logged in by name. In most cases this should provide read-only access.
<li>The special login name <code>__DEFAULT__</code> applies to any
    valid LDAP login that does not have its own individual entry in
    the user map. The token <code>__USERNAME__</code> can be used
    within the LDAP name to represent the name the user logged in with.
<li>Login names can be mapped to the special LDAP name <code>__DENY__</code>
    in order to deny access to the directory.
</ul>
<p>
The following settings can be applied to each user map entry
in order to enable or disable various features of the
address book. To use each feature, the necessary permissions
will need to be granted within the back-end directory.
</p>
<table border=1>
<tr><th>Setting</th><th>Description</th></tr>
<tr><td><code>allow_browse</code></td><td>Allows the user to browse through
 organisational units (folders) within the address book.</td></tr>

<tr><td><code>allow_create</code></td><td>Allows the user to create new
 records within the address book. They will also need to be granted
 <code>allow_edit</code> in order to populate and save the new record's attributes.</td></tr>

<tr><td><code>allow_delete</code></td><td>Allows the user to delete records
 within the address book.</td></tr>

<tr><td><code>allow_edit</code></td><td>Allows the user to edit records
 within the address book.</td></tr>

<tr><td><code>allow_search</code></td><td>Allows the user to search the
    address book directory tree.</td></tr>
<tr><td><code>allow_view</code></td><td>Allows the user to click on a record
    to see full details</td></tr>

<tr><td><code>allow_export</code></td><td>Allows the user to save/export
    (individual) records as vCard electronic business cards.</td></tr>

<tr><td><code>allow_export_bulk</code></td><td>Allows the user to
    export entire OUs of records (or the complete address book) in vCard
    format, for example to import into another address book or
    contact database that doesn't support LDAP directly.</td></tr>

</table>

<p>
The following example shows how to grant all logged in users permission
to browse, search and view Microsoft Active Directory (domain name
<code>example.org</code>):
</p>
<pre>
array("login_name"=&gt;"__DEFAULT__","ldap_name"=&gt;"__USERNAME__@example.org",
        "allow_browse"=&gt;true,
        "allow_search"=&gt;true,
        "allow_view"=&gt;true
        )
</pre>
<p>
To connect to Active Directory, <code>ldap_name</code> should be a user
principal name (UPN), i.e. the user name as entered into the login
box followed by <code>@</code> followed by the domain's DNS name (or
other allowed UPN suffix, if any have been configured).
</p>
<p>
The following example shows how to grant browse, search and view
permission to all users inside the <code>home</code> container at the
top level of a Novell eDirectory tree:
</p>
<pre>
array("login_name"=>"__DEFAULT__","ldap_name"=>"cn=__USERNAME__,dc=home",
        "allow_browse"=&gt;true,
        "allow_search"=&gt;true,
        "allow_view"=&gt;true
        )
</pre>
<p>
<img src="edir.png">
</p>
<p>
The following set of user map entries:
</p>
<ul>
<li>Allow users to browse and search the directory without having to
    explicitly log in.
<li>Define an address book administrator (who logs in as <code>admin</code>).
<li>Disallow other users from logging in by name.
</ul>
<p>
(The anonymous users access the directory as LDAP user
<code>ldap-browse@example.org</code>, password <code>foobar</code>. The
address book login name <code>admin</code> is mapped to
<code>Administrator@example.org</code>.)
</p>
<pre>
array("login_name"=&gt;"__ANONYMOUS__","ldap_name"=&gt;"ldap-browse@example.org",
	"ldap_password=&gt;"foobar",
        "allow_browse"=&gt;true,
        "allow_search"=&gt;true,
        "allow_view"=&gt;true
	),
array("login_name"=&gt;"admin","ldap_name"=&gt;"Administrator@example.org",
        "allow_browse"=&gt;true,
        "allow_create"=&gt;true,
        "allow_delete"=&gt;true,
        "allow_edit"=&gt;true,
        "allow_search"=&gt;true,
        "allow_view"=&gt;true
	),
array("login_name"=&gt;"__DEFAULT__","ldap_name"=&gt;"__DENY__"
	)
</pre>
<p>
The following example disables anonymous access, requiring all users
to log in by name in order to browse the directory.
</p>
<pre>
array("login_name"=&gt;"__DEFAULT__","ldap_name"=&gt;"__USERNAME__@example.org",
        "allow_browse"=&gt;true,
        "allow_search"=&gt;true,
        "allow_view"=&gt;true
	),
array("login_name"=&gt;"__ANONYMOUS__","ldap_name"=&gt;"__DENY__",
	"ldap_password=&gt;"foobar",
	)
</pre>
<h3>Changing the attributes shown for search results</h3>
<p>
The fields/attributes that are used when searching can be customised
by editing the contents of <code>$search_ldap_attrib</code>
in the configuration file. The default setting is:
</p>
<pre>
$search_ldap_attrib = array(
        "cn","mail","sn","displayName","company","title");
</pre>
...which searches the following set of attributes:
</p>
<table border=1>
<tr><th>Attribute</th><th>Description (typical usage)</th></tr>
<tr><td><code>cn</code></td><td>Name of the directory entry itself
    (usually a person's full name or "common name")</td></tr>
<tr><td><code>mail</code></td><td>E-mail address</td></tr>
<tr><td><code>sn</code></td><td>Surname</td></tr>
<tr><td><code>displayName</code></td><td>Perferred display version of
    user's name. Some users may prefer informal versions of their
    name (e.g. "Andy" instead of "Andrew"), which would be represented
    here.</td></tr>
<tr><td><code>company</code></td><td>Company name</td></tr>
<tr><td><code>title</code></td><td>Job title</td></tr>
</table>
<p>
See your directory service's schema documentation for
other attributes which are available to be searched.
</p>
<p>
The columns that appear in search results can be changed
by editing the contents of <code>$search_result_columns</code> in the
config file.
</p>
<p>
The special attribute <code>sortableName</code> can be used to display a
"sort-friendly" version of a personal name (Surname, Firstname)
where this information is available. (This is constructed from
the <code>sn</code> and <code>givenName</code> attributes if populated,
otherwise falling back to <code>displayName</code> and <code>cn</code>.)
</p>
<h3>Applying language-specific sorting rules for search results</h3>
<p>
Certain languages and countries have their own specific sorting
rules (e.g. the sequence in which alphabetic characters follow each other).
Where necessary, these rules can be selected through the
<code>$lc_collate</code> setting in <code>config.php</code>:
</p>
<p>
<code>$lc_collate = "&lt;language&gt;[_&lt;territory&gt;][.&lt;codeset&gt;][@&lt;modifier&gt;]";</code>
</p>

<p>
In practice neither the code set or modifier are widely used, and 
in most cases only the language and territory need to be defined, for
example:
</p>
<p>
<code>$lc_collate = "en_US";</code>
</p>
<p>
(a code set of UTF-8 will be assumed automatically.)
</p>
<h3>Applying custom LDAP filters to directory browsing and searching</h3>
<p>
If is possible to customise the LDAP queries which are used to fetch
data from the directory, for example to display only records which
have specific object classes or meet some other criteria.
</p>
<p>
Sites with Microsoft Active Directory/Exchange may wish to set up
custom filters that test the <code>msExchHideFromAddressLists</code>
and/or <code>showInAddressBook</code> attributes in order to exclude
those entries which are hidden from Exchange's Global Address Book
(GAL).
</p>
<h4>Directory browsing</h4>
<p>
When the user browses through the directory tree directory, the
address book retrieves all records at the user's location
(LDAP base search) that match the criteria specified
by <code>$browse_ldap_filter</code> in <code>config.php</code>.
The default LDAP filter is as follows, which allows all
objects to be displayed:
</p>
<p>
<code>$browse_ldap_filter = "objectClass=*";</code>
</p>
<h4>Search results</h4>
<p>
Searches results are retrieved by carrying out an LDAP
subtree search from the root of the address book (as
specified in <code>$ldap_base_dn</code>). The expression to be searched
for is based on the value of <code>$search_ldap_filter</code>
in <code>config.php</code>. The default LDAP filter is as
follows, which limits search results to objects representing
people:
</p>
<p>
<code>$search_ldap_filter = "(&(objectClass=person)___search_criteria___)";</code>
</p>
<p>
The token <code>___search_criteria___</code> will be replaced with an
expression to search the attributes listed in <code>$search_ldap_attrib</code>
for the string entered by the user. For example if the user searched
for "smith", the token would be replaced by:
</p>
<p>
<code>(|(cn=smith)(mail=smith)(sn=smith)(displayName=smith)(company=smith)(title=smith))</code>
</p>
<p>
To allow all object types to appear in search results, including
organisational units (which typically do not have a <code>cn</code>
attribute set), make the following changes to <code.config.php</code>:
</p>
<ul>
<li>Set <code>$search_ldap_filter = "___search_criteria___";</code>
<li>Add <code>ou</code> to the list of attributes to be searched
    in <code>$search_ldap_attrib</code>.
</ul>
<h3>Changing the layout and attributes shown for directory entries</h3>
<p>
You may want to customise the way in which address book
entries are displayed - which fields/attributes are
used and how they are laid out. The columns that appear
in search results can be changed by editing the contents of
<code>$entry_layout</code> in the configuration file.
</p>

<p>
Note: Some attributes must always be filled in with a value, for
example many LDAP directories require record types that represent
a person to have the surname (<code>sn</code>) attribute to be
filled in. If you want to be able to create new records through
the Address Book then these attributes must be included in your
directory entry layout so that you can fill them in.
</p>
<ul>
<li><i>Configuring users and permissions</i> (above) describes how
to allow creating/editing of records.

<li>Your directory service's schema documentation should list which
attributes must have values.
</ul>
<p>
As shipped, address book entries are displayed in three
"sections":
</p>
<img alt="Default address book layout, with personal, business/work and additional notes sections" src="layout.png">
<p>
The sections appear in <code>$entry_layout</code> as
a comma-separated list of arrays. The first section in
the screenshot above ("Personal") is represented like
this:
</p>
<pre>
$entry_layout = array(
        array("section_name"=&gt;"Personal",
                "attributes"=&gt;array(
                        array("givenName",			"Given Name",		"contact24.png",true),
                        array("sn",				"Surname",		"contact24.png",true),
                        array("cn",				"Full Name",		"contact24.png",true),
                        array("displayName",                    "Preferred Name",       "contact24.png"),
                        array("mail",                           "E-mail",               "mail.png"),
                        array("homePhone",                      "Home Phone",           "landline-phone.png"),
                        array("mobile",                         "Mobile Phone",         "cell-phone.png"),
                        array("wWWHomePage",                    "Web Page",             "internet.png"),
                        array("streetAddress:l:st:postalCode",  "Postal Address",       "address.png"),
                        array("c",                              "Country",              "country.png")
                        )
                ),

		// ... data for the other sections continues here (not shown) ...
		// ... sections are separated from each other by commas ...

	);
</pre>
<p>
The <code>givenName</code>, <code>sn</code> and <code>cn</code>
fields are only visible while the record is being edited. (This
behavior is enabled by setting the fouth attribute of each
layout element to <code>true</code>.)
</p>
<p>
You can define the following settings for each section:
</p>
<table border=1>
<tr><th>Setting</th><th>Description</th><th>Default if not set</th></tr>
<tr><td><code>section_name</code></td>
    <td>Title to appear above the section.</td>
    <td>Title is not shown.</td></tr>

<tr><td><code>new_row</code></td>
    <td>Whether or not this section should start on a new row.<br>
        In the default setup the "Business/Work" section has
        <code>"new_row"=&gt;false</code> set, so it is displayed to
        the right of "Personal" on the same row. "Additional Notes"
        has <code>"new_row"=&gt;false</code> set, so appears on its
        own row below the previous sections.</td>
        <td>Assumed to be <code>false</code></td></tr>

<tr><td><code>width</code></td>
    <td>Width of the section, specified as a number followed by
        any of the following measurement units (which are those
        supported by the CSS standard):
        <ul>
        <li>% - percentage of the available width
        <li>px - pixels
        <li>em - current font size (traditionally the width of the letter
                 "m" in the font)
        <li>ex - half current font size (traditionally the height of the
                 letter "x" in the font; or the distance between the font
                 baseline and median)
        <li>cm - centimetres
        <li>mm - millimetres
        <li>in - inches
        <li>pt - points (1/72 of an inch)
        <li>pc - picas (1/6 of an inch, or 12 points)
        </ul>
        In the default setup the width of "Business/Work" is set
        to "50%". Any sections on the same row that don't have a
        specified width will automatically use up the remaining
        space.</td>
    <td>User's browser divides up the available width based on
        amount of data to be shown in each section</td></tr>

<tr><td><code>colspan</code></td>
    <td>Number of HTML table columns that this section should span.<br>
        In the default setup the "Additional Notes" section has
        <code>"colspan"=&gt;2</code> set, so spans the width of both
        the "Personal" and "Business/Work" columns.</td>
    <td>Assumed to be <code>1</code></td></tr>

<tr><td><code>attributes</code></td>
    <td>List of attributes to appear in the section.</td>
    <td>(always required)</td></tr>
</td></tr>
</table>
<p>
Each attribute is described by either three or four items:
</p>
<ol>
<li>The name of the LDAP attribute (or list of attributes) to be displayed
<li>The caption text to appear next to the attribute (or leave
    empty - "" - for no caption)
<li>Icon image to appear next to the attribute (or leave empty for none)
<li>Whether the attribute should be visible only while the record is
    being edited
</ol>
<p>
A display field can be constructed from several LDAP attributes. To
construct a field from multiple attributes, list the attributes in
turn, separating them with one of the following symbols:
</p>
<table border=1>
<tr><th>Symbol</th><th>Meaning</th></tr>
<tr><td><code>:</code></td><td>Separate attributes with a line break</td></tr>
<tr><td><code>+</code></td><td>Separate attributes with a space</td></tr>
</table>
<p>
This facility is often used to display the lines of an address.
(If the address attributes in your LDAP directory are used to store
business addresses rather than personal addresses you may want
to relocate the "Address" field from the "Personal" to the
"Business/Work" section of the display.)
</p>
<p>
The following changes will be applied automatically:
</p>
<ul>
<li><p>Any web page URLs and e-mail addresses will be presented as
    clickable HTML links.</p>
<li><p>The <code>postalCode</code> attribute is followed by a
    "View Map" link that displays the corresponding location
    in Google Maps (provided that the postal code is valid and
    recognised).</p>

<li>Images contained in the <code>jpegPhoto</code>,
    <code>thumbnailPhoto</code> or <code>thumbnailLogo</code> attributes
    will be scaled to the size indicated by <code>$photo_image_size</code>
    in <code>config.php</code> (96x96 pixels by default). If this
    value is not set then the images will be shown at their native
    size.
</ul>

<h3>Displaying thumbnail photos or logos when browsing/searching the directory</h3>
<p>
By default, directory entries are displayed next to an
icon representing their object class. Alternatively, the address
book can be set to display an image - typically a photo or logo -
representing the object instead. These images are retrieved from
the following LDAP attributes (listed in order of priority):
</p>
<table border=1>
<tr><th>Attribute</th><th>Description</th></tr>
<tr><td><code>jpegPhoto</code></td><td>Used to store one or
   more images of a person using the JPEG File Interchange
   Format. (Standard ref: IETF RFC 2798) In practice the
   Address Book will only display the first stored image.
</td></tr>
<tr><td><code>thumbnailPhoto</code></td><td>Stores a single
    thumbnail image, maximum size 100K. (Non-standard/Microsoft
    specific)</td>

<tr><td><code>thumbnailLogo</code></td><td>Stores a single
    thumbnail image, maximum size 32K. (Non-standard/Microsoft
    specific)</td>
</table>
<p>
The LDAP Address Book can also display PNG, GIF, WBMP, and GD2 images
stored in these attributes, although JPEG is recommended in all
cases. (WBMP is not the same thing as Microsoft Windows BMP,
which is not supported.) Your PHP installation must have
GD Graphics Library support enabled in order to display image
attributes.
</p>
<p>
To display thumbnail photos/logos instead of "generic" icons,
set one or both of the following options in <code>config.php</code>:
</p>
<table border=1>
<tr><th>Setting</th><th>Description</th></tr>
<tr><td><code>$enable_search_browse_thumbnail = true;</code></td>
    <td>Display thumbnail photos when browsing and in search results</td></tr>

<tr><td><code>$enable_ldap_path_thumbnail = true;</code></td>
    <td>Display thumbnail photo in detail view navigation path</td></tr>
</table>
<p>
Beware that setting <code>$enable_search_browse_thumbnail = true</code>
can result in slow page loading if there are a large number of
images to be displayed.
</p>
<p>
A larger version of these images can be shown on the entry's
detailed view by adding the <code>jpegPhoto</code> and/or
<code>thumbnailPhoto</code> to the display layout (as described
in the previous section). The following settings control the image
size:
</p>
<table border=1>
<tr><th>Setting</th><th>Default value</th><th>Description</th></tr>
<tr><td><code>$thumbnail_image_size</code></td>
    <td><code>24x24</code></td>
    <td>Size of thumbnail images displayed in search results
         and/or detail view navigation path, measured in pixels. For
         optimal layout the size should be the same as the icons
         used to represent object schema classes (24x24 as shipped).
         </td></tr>

<tr><td><code>$photo_image_size</code></td>
    <td><code>96x96</code></td>
    <td>Size of large images displayed in detail view, measured in
        pixels. Set this value to an empty string (or leave
        undefined) to disable scaling of these images.</td></tr>
</table>
<p>
Android devices (at least as of version 4.4) will display the
logo in preference to the photograph wherever a contact record
includes both. To omit the logo from any records that have a photo
(so that the photo will be used) when saving as vCard, set the
following option in <code>config.php</code>:
</p>
<p>
<code>$exclude_logo_if_photo_present = true;</code>
</p>
<h3>Setting up phone numbers to be dialed when clicked on</h3>
<p>
Phone numbers appearing in the directory can be set to be displayed
as HTML links rather than plain text, usually so that the
number will be dialed when clicked on. The way that phone numbers
are converted into URLs can be configured via the
<code>$phone_number_link_template</code> setting in order to
support different types of "click-to-dial" software.
</p>
<p>
The following setting allows many mobile phone browsers and other
platforms that have built-in phone support to dial a number when
clicked on:
</p>
<p>
<code>$phone_number_link_template = "tel:___phone_number___";</code>
</p>
<p>
The following setting will enable phone numbers to be dialed
using Microsoft Skype or other software that handles the
(non-standard) <code>callto:</code> URI scheme:
</p>
<p>
<code>$phone_number_link_template = "callto://___phone_number___";</code>
</p>
<p>
The following settings show how to place a call by passing the
phone number to a separate web application such as Cisco WebDialer:
</p>
<p>
<code>$phone_number_link_template = "https://cucm01/webdialer/Webdialer?destination=___phone_number___";<br>
$phone_number_link_target = "_blank";</code>
</p>
<p>
If defined, the <code>$phone_number_link_target</code> setting
can be used to force the dialer application to open in a
separate window/tab.
</p>
<p>
Columns in browse/search result lists that contain clickable
phone numbers should have their column link type set to
<code>phone_number</code> in the
<code>$search_result_columns</code> configuration.
</p>
<h3>Changing the links shown in the page footer</h3>
<p>
The links shown in the page footer can be changed using the
<code>$site_footer_links</code> option in <code>config.php</code>.
The default set of links are defined as follows:
</p>
<pre>
$site_footer_links = array(
        array("url"=&gt;"doc/","text"=&gt;"User Guide"),
        array("url"=&gt;"https://sourceforge.net/projects/ldap-addr-book/",
                "text"=&gt;"Get Source Code")
        );
</pre>
<p>
Each link is represented by an array containing its URL and the
name/label text to be displayed.
</p>
<p>
Note: The application's software license requires that you provide
users with a means of obtaining a copy of the source code. As such
you are recommended not to remove the "Get Source Code" link from
the footer, although you may change it to a more appropriate URL
where necessary (e.g. to a copy containing your own local changes,
or if users have only limited connectivity to the external Internet
that would prevent them from accessing the default location.)
</p>
<p>
Please see the <a href="license.html">license agreement</a> for
full information.
</p>
<h3>Changing the look and formatting of the address book</h3>
<p>
The appearance (such as font, text size, colours, etc) of the
address book is defined in the file <code>styles.css</code>.
</p>
<p>
<a href="../styles.css">Take a look at the stylesheet file
(<code>styles.css</code>)</a>
</p>
<p>
You can change any of these settings (or add your own) by creating
your own stylesheet file, called <code>styles_local.css</code> and
adding your changes to it. (Although you could modify
<code>styles.css</code> directly it will be easier to upgrade to
future versions of the address book if you keep your changes
separate by using <code>styles_local.css</code> instead.)
</p>
<p>
The stylesheet file is made up of
<span style="font-style:italic">selectors</span> which specify which
part of the user interface is to be changed, followed by
<span style="font-style:italic">style directives</span> surrounded
by {...} to define how it should appear. For example, if you wanted to
dispay the address book in a different font you might add
the following to your own <code>styles_local.css</code> file and
change the <code>font-family</code> setting to your own choice of font:
</p>
<pre>
body,table,textarea {
        font-family:serif;
}
</pre>
<p>
Where you don't redefine a setting in <code>styles_local.css</code>
(such as <code>font-size:10pt</code> in this example) the value
from <code>styles.css</code> will continue to be used.
</p>
<p>
The following table summarises the CSS selectors used within
<code>styles.css</code> and which part of the address book's
appearance they affect:
</p>
<table border=1>
<tr><th>CSS Selector</th><th>Typically used to change the font, size,
        colour, etc, of...</th></tr>
<tr><td><code>body,table,textarea</code></td>
    <td>The address book as a whole.</td></tr>
<tr><td><code>.ldap_navigation_path li:first-child</code></td>
    <td>The address book title, which is shown as the left-most item in the
        "Navigation Path" shown at the top of each page.</td></tr>

<tr><td><code>.ldap_navigation_path li+li:before</code></td>
    <td>Organisational units, folders, etc, shown in the
        "Navigation Path" at the top of each page. The left-most
        element of the navigation path (typically used to show
        the address book title) is styled separately, described
        above.</td></tr>

<tr><td><code>.page_footer</code></td>
    <td>Page footer.</td></tr>

<tr><td style="white-space:nowrap">
    <code>.ldap_entry_viewer_section .column_header,<br>
        .search_results_viewer .column_header</code></td>
    <td>Column headers/titles used in search results and
        directory entries.(*)</td></tr>

<tr><td><code>.ldap_entry_viewer_section td,<br>
        .search_results_viewer td</code></td>
    <td>Data displayed in search results and directory entries.(*)
        Note: The appearance of LDAP attributes can be customised
        individually, as described below.</td></tr>

<tr><td><code>.ldap_entry_viewer_section th</code></td>
    <td>Name/label text that appears to the left of each
        attribute shown in a directory entry.</td></tr>

</table>
<p>
(* These may be split into two separate style declarations if
you want to customise the search results and directory entry
detail pages separately.)
</p>
<p>
You can also change the way in which an individual LDAP attribute
is displayed by applying style directives to
 <code>.ldap_attribute_&lt;attrib&gt;</code>,
where <code>&lt;attrib&gt;</code> is the attribute to be
customised. <p>For example, adding the following to
<code>styles_local.css</code> will cause home telephone numbers
(stored in the <code>homePhone</code> attribute) to be displayed
in italic:
</p>
<pre>
.ldap_attribute_homePhone
{
        font-style:italic;
}
</pre>
<p>
As a further example, adding the following to <code>styles_local.css</code>
will display SSH public keys (stored in the <code>sshPublicKey</code>
attribute) to be displayed in a fixed-width font and word-wrapped more
appropriately:
</p>
<pre>
.ldap_attribute_sshPublicKey
{
        font-family:monospace;
        word-break:break-all;
}
</pre>
<hr>
<a name="config_reference"></a>
<h2>Configuration Reference</h2>
<table border=1>
<tr><th>Setting</th><th>Description</th></tr>
<tr><td><code>$site_name</code></td><td>Site name, which appears in the
        browser title bar. You may want to
		customise this, e.g. with your company name.
                <p>Example:<br>
                <code>$site_name = "BigCorp Address Book";</code>
                </p></td></tr>

<tr><td><code>$site_footer_links</code></td><td>List of links that
     appear in the footer of each page.
     <p>Example:<br>
<pre>$site_footer_links = array(
        array("url"=&gt;"doc/","text"=&gt;"User Guide"),
        array("url"=&gt;"https://sourceforge.net/projects/ldap-addr-book/",
                "text"=&gt;"Get Source Code")
        );</pre>
     </p>
</td></tr>

<tr><th colspan=2>Connection to LDAP Directory</th></tr>

<tr><td><code>$ldap_server</code></td>
    <td>Creates a connection to the LDAP server holding the address book
    data. The following information needs to be provided about the server:
    <ul>
    <li><p>LDAP server type. The following
        values are accepted:</p>
        <p>
        <code>ad</code> - Microsoft Active Directory
        (or Samba 4 Active Directory)<br>
        <code>edir</code> - Novell eDirectory<br>
        <code>openldap</code> - OpenLDAP (core/inetorgperson schema)</p>
    <li><p>Host name, port number or LDAP URL</p>
    <li><p>Port number (optional)</p>
    </ul>
    <p>Examples:<br>
    <code>$ldap_server = new ldap_server("openldap","ldap.example.org");</code><br>
    <code>$ldap_server = new ldap_server("openldap","ldapi://",0);</code>
     - connect to local server via a UNIX domain socket</p>



    <p>Active Directory-specific Options:</p><p>
    (1) As an alternative to giving the name of a specific server (domain
    controller) you can specify just the domain name. This will load
    balance the connections across the available domain controllers.
    (See Microsoft KB 842197 for further information on how to use DNS
    netmask ordering for more fine-grained control of the servers
    used for load balancing.)</p>
    <p>
    (2) For multi-domain forests, specify the LDAP port number as 3268
    in order to use the AD Global Catalogue. (By comparison, using the
    default LDAP port (389) will return incomplete information other
    than for the local AD domain.)
    </p>
    <p>
    <code>$ldap_server = new ldap_server("ad","example.org");</code>
     - load balances across the DCs as listed in DNS<br>
    <code>$ldap_server = new ldap_server("ad","dc1.example.org",3268);</code>
     - use AD global catalogue port<br>
    </p>
    <p>
    For further information,
    see:<a href="http://www.php.net/manual/en/function.ldap-connect.php">
    http://www.php.net/manual/en/function.ldap-connect.php</a>
    </p>
    </td></tr>

<tr><td><code>$ldap_base_dn</code></td><td>Specifies the search base
    within the directory which will be used for displaying the address
    book. Rather than searching the whole directory, you can use this
    option to restrict search results to only a specific part of the
    directory tree which contains the user accounts or contacts.
    <p>
    Examples:<br>
    <code>$ldap_base_dn = "dc=example,dc=org";</code><br>
    <code>$ldap_base_dn = "ou=Users,dc=example,dc=org";</code>
    </p>
    <p>
    Syntax where one of the OU names contains a space:<br>
    <code>$ldap_base_dn = "ou=User Accounts,dc=example,dc=org";</code>
    </p>
</td></tr>

<tr><td><code>$ldap_default_user</code></td>
    <td>User name which will be used by the address book software to
    access the LDAP directory service (also known as "binding" to the
    directory). The corresponding password should be provided in
    <code>$ldap_default_password</code>. If you have enabled
    authenticated access to the directory then these settings will
    be used only when nobody is logged in (e.g. to provide read-only
    access).
    <p>
    Examples:<br>
    <code>$ldap_default_user
    = "cn=LDAPUser,cn=Users,dc=example,dc=org";</code><br>
    <code>$ldap_default_user = "cn=LDAPUser,dc=MyDirectory";</code><br>
    <code>$ldap_default_user  = "LDAPUser@example.org";</code>
     - Active Directory specific syntax<br>
    </p>
    <p>If the directory is set up to allow read access without having
    to log on then just leave the user name and password blank
    (which will perform an "anonymous bind").</p></td></tr>

<tr><td><code>$ldap_default_password</code></td>
    <td>Password corresponding to the account specified in
    <code>$ldap_default_user</code>, which is used by the
    address book software to access the LDAP directory service (also
    known as "binding" to the directory). If you have enabled
    authenticated access to the directory then these settings will
    be used only when nobody is logged in (e.g. to provide read-only
    access).
    <p>Example:<br>
    <code>$ldap_default_password  = "password";</code>
    </p></td></tr>

<tr><td><code>$ldap_user_map</code></td>
    <td>Specifies the mapping between address book logins and the
    back-end directory when per-user authentication is enabled.
    (see "Configuring users and permissions" above.)
    <p>Example:<br>
    <pre>$ldap_user_map = array(
        array("login_name"=&gt;"__ANONYMOUS__","ldap_name"=&gt;$ldap_default_user,
                "ldap_password"=&gt;$ldap_default_password,
                "allow_browse"=&gt;true,
                "allow_search"=&gt;true,
                "allow_view"=&gt;true
                ),
        array("login_name"=&gt;"__DEFAULT__","ldap_name"=&gt;"__USERNAME__@example.org",
                "allow_browse"=&gt;true,
                "allow_search"=&gt;true,
                "allow_view"=&gt;true
                )
        );</pre></p></td></tr>

<tr><td><code>$ldap_server->follow_referrals</code></td>
    <td>Causes the address book to attempt to follow LDAP referrals.
     <br>&nbsp;<br>
     Referrals are used where the contents of the LDAP directory
     are divided between several servers, with a different section
     of the directory stored on each. This is normally used only
     in larger organisations. A referral is a message which indicates
     that the requested information is stored
     on a different server. If <code>follow_referrals</code>
     is set to true the Address Book will attempt to connect to
     the other server to retrieve the information.
     <br>&nbsp;<br>
     Beware: This feature is currently experimental.
     <br>&nbsp;<br>
     In Microsoft Active Directory, referrals are used where
     several domains have been joined into a "forest". As an
     alternative to using referrals, the LDAP Address Book can
     be set up to use the forest's Global Catalog (by connecting
     to an alternate LDAP service running on port 3268 - see
     description of <code>$ldap_server</code> above). Not all
     attributes are stored in the Global Catalogue by
     default - for example job titles and department information.
     Missing attributes can be added to the Global Catalog
     using the "Active Directory Schema" admin tool.
     <p>
     Example:<br>
     <code>$ldap_server->follow_referrals = true;</code>
     </p></td></tr>

<tr><th colspan=2>Search/Browse Directory Settings</th></tr>

<tr><td><code>$search_ldap_attrib</code></td>
    <td>This specifies which attributes (fields) get searched when a
     user searches the address book. Add to the list if you have
     specific requirements, e.g. if you want users to be able to
     search on a department name (department) or building
     (physicalDeliveryOfficeName).
     <p>
     Example:<br>
     <code>$search_ldap_attrib = array("cn","mail","sn","displayName","company","title");</code>
     </p></td></tr>

<tr><td><code>$search_ldap_filter</code></td>
    <td>Specifies the LDAP filter to be applied when searching
     through records in the directory. The token
     <code>___search_criteria___</code> will be replaced with
     an expression to search the attributes listed in
     <code>$search_ldap_attrib</code> for the string entered by
     the user.
     <p>
     Example:<br>
     <code>$browse_ldap_filter = "(&(objectClass=person)___search_criteria___)";</code>
     </p></td></tr>

<tr><td><code>$browse_ldap_filter</code></td>
    <td>Specifies the LDAP filter to be applied when browsing
     through records in the directory. This is normally set to
     <code>objectClass=*</code>, which allows all records in
     the directory to be displayed.
     <p>
     Example:<br>
     <code>$browse_ldap_filter = "objectClass=*";</code>
     </p></td></tr>

<tr><td><code>$search_result_columns</code></td>
    <td>Specifies the column layout to be used for displaying
    search results. Each column has three fields associated with it:
    <ul>
    <li><code>caption</code> - Caption to appear in column heading
    <li><code>attrib</code> - LDAP attribute to display
    <li><code>link_type</code> - Whether and how to display the attribute
        as a hyperlink
    </ul>
    The special attribute <code>sortableName</code> will display constructed
    "sort-friendly" version of a personal name (Surname, Firstname)
    based on which LDAP attributes are populated. (Ideally
    <code>sn</code> and <code>givenName</code> if populated, otherwise
    falling back to <code>displayName</code> or <code>cn</code>.) The
    following link types are supported:
    <ul>
    <li><code>object</code> - Link to the object record. Recommended to
    use this link type for the object name, displayed in the left-most column.
    <li><code>mailto</code> - Display as <code>mailto:</code> link, e.g.
    for attributes containing e-mail addresses.
    <li><code>url</code> - Attribute contains a URL which should be shown as
    a link.
    <li><code>phone_number</code> - Display as a link to dial a phone
    number. (e.g. as a tel: URL)
    <li><code>none</code> - Do not display as a link.
    </ul>
    Example:
    <pre>$search_result_columns = array(
        array("caption"=&gt;"Name",                "attrib"=&gt;"sortableName",       "link_type"=&gt;"object"),
        array("caption"=&gt;"E-Mail",              "attrib"=&gt;"mail",               "link_type"=&gt;"mailto"),
        array("caption"=&gt;"Office Phone",        "attrib"=&gt;"telephoneNumber",    "link_type"=&gt;"phone_number"),
        array("caption"=&gt;"Organisation",        "attrib"=&gt;"company",            "link_type"=&gt;"none")
        );</pre>
</td></tr>

<tr><td><code>$search_result_default_sort_order</code></td>
    <td>Specifies the default sort order for displaying search
     results. User can change the sort order by clicking a column
     header.
     <p>
     Example:<br>
     <code>$search_result_default_sort_order = "sortableName";</code>
     </p></td></tr>

<tr><td><code>$enable_search_suggestions</code></td>
    <td>Specifies whether search results from the directory
    should be the &quot;suggested&quot; as the user types in
    search terms. It may be more appropriate to disable this
    facility in large installations in order to reduce
    server load.
    <p>
    Example:<br>
    <code>$enable_search_suggestions = true;</code>
    </p></td></tr>

<tr><td><code>$lc_collate</code></td>
    <td>Specifies the collation locale (sorting language/region/script)
    to be used for browsing and displaying search results.
    <p>
    Example:<br>
    <code>$lc_collate = "en_US";</code>
    </p></td></tr>

<tr><th colspan=2>Detailed Info View</th></tr>

<tr><td><code>$entry_layout</code></td>
    <td>Specifies the attributes to be shown in detailed entry view
    and how they should be layed out. See the section "Changing the
    layout and attributes shown for directory entries" above for
    further information.
<p>Example:<br>
<pre>
$entry_layout = array(
        array("section_name"=&gt;"Personal",
                "attributes"=&gt;array(
                        array("displayName",                    "Preferred Name",       "contact24.png"),
                        array("mail",                           "E-mail",               "mail.png"),
                        array("homePhone",                      "Home Phone",           "landline-phone.png"),
                        array("mobile",                         "Mobile Phone",         "cell-phone.png"),
                        array("wWWHomePage",                    "Web Page",             "internet.png"),
                        array("streetAddress:l:st:postalCode",  "Postal Address",       "address.png"),
                        array("c",                              "Country",              "country.png"),
                        array("jpegPhoto",                      "Photo",                "photo24.png")
                        )
                ),
        array("section_name"=&gt;"Business/Work","width"=&gt;"50%",
                "attributes"=&gt;array(
                        array("company",                        "Company",              "company.png"),
                        array("url",                            "Web Page",             "internet.png"),
                        array("telephoneNumber",                "Office Phone",         "landline-phone.png"),
                        array("facsimileTelephoneNumber",       "Office Fax",           "fax.png"),
                        array("title",                          "Job Title",            "id.png"),
                        array("department",                     "Department",           "org.png"),
                        array("physicalDeliveryOfficeName",     "Office",               "office.png")
                        )
                ),

        array("section_name"=&gt;"Additional Notes","new_row"=&gt;true,"colspan"=&gt;2,
                "attributes"=&gt;array(
                        array("info")
                        )
                )
        );

</pre>
</p></td></tr>

<tr><th colspan=2>Photo/Image Display Settings</th></tr>

<tr><td><code>$enable_search_browse_thumbnail</code></td>
    <td>Specifies whether thumbnail images should be displayed next
        to directory entries in browse/search results view
        (if available) instead of object class icons.
        <p>Example:<br>
        <code>$enable_search_browse_thumbnail = true</code></p></td></tr>

<tr><td><code>$enable_ldap_path_thumbnail</code></td>
    <td>Specifies whether thumbnail images should be displayed in
        the detailed info view's "navigation path" (if available)
        instead of object class icons.
        <p>Example:<br>
        <code>$enable_ldap_path_thumbnail = true</code></p></td></tr>

<tr><td><code>$thumbnail_image_size</code></td>
    <td>Size to which images should be scaled for use as
        thumbnails/icons.
        <p>Example:<br>
        <code>$thumbnail_image_size = "24x24";</code>
        </p></td></tr>

<tr><td><code>$photo_image_size</code></td>
    <td>Size to which images should be scaled for display in
        the detailed info view. Set to an empty string (or
        leave undefined) to disable scaling of these
        images.
        <p>Example:<br>
        <code>$photo_image_size = "96x96";</code>
        </p></td></tr>

<tr><th colspan=2>Computer/Telephony Integration Settings</th></tr>

<tr><td><code>$phone_number_link_template</code></td>
    <td>Specifies if and how phone numbers should be displayed
        as clickable links (e.g. to support "click-to-dial"
        functionality). Leaving this setting blank (or not setting
        it at all) will display phone numbers as plain text rather
        than a link.
        <p>
        The token "___phone_number___" will be replaced with the
        actual phone number to be dialed.
        </p>
        <p>Examples:</p>
        <p>Enable click-to-dial support on many mobile phone web browsers:</p>
        <p><code>$phone_number_link_template = "tel:___phone_number___";</code></p>
        <p>Enable click-to-dial by calling Cisco WebDialer 
        running on host <code>cucm01</code>:</p>
        <p><code>$phone_number_link_template = "https://cucm01/webdialer/Webdialer?destination=___phone_number___";<br>
        $phone_number_link_target = "_blank";</code>
        </p></td></tr>

<tr><td><code>$phone_number_link_target</code></td>
    <td>Specifies a value for a phone number link's "target" attribute.
        It may be useful to set this to "_blank" for certain
        click-to-dial software or if the address book is set up to run
        inside a HTML frame.
        <p>Example:<br>
        <code>$phone_number_link_target = "_blank";</code>
        </p></td></tr>

<tr><th colspan=2>Data Export Settings</th></tr>

<tr><td><code>$exclude_logo_if_photo_present</code></td>
    <td>Specifies whether logo images (from the
        <code>thumbnailLogo</code> attribute) should be
        omitted when exporting as vCard if a photograph is
        also present. This may be useful when transfering
        records from the Address Book to Android devices.
        <p>Example:<br>
        <code>
        $exclude_logo_if_photo_present = true;</code>
        </p></td></tr>

</table>
</body>
</html>
